var BreakpointLivePreview=function(h,i,n){"use strict";h=h&&h.hasOwnProperty("default")?h.default:h,i=i&&i.hasOwnProperty("default")?i.default:i,n=n&&n.hasOwnProperty("default")?n.default:n;var t=function(t){return h.map(t,function(t){return[t]})},l=function(t){return i.t("breakpoint",t)},e=function(t){return Math.round(100*t)+"%"},d=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return h("<option>").text(t).attr("value",e)},c=function(){return d("───").attr("disabled",!0)},s=n.Base.extend({x:0,y:0,zoom:-1,currentPreset:-1,$root:null,$trigger:null,$viewport:null,_enabled:!1,_livePreview:null,init:function(t){var e=this;this.setSettings(t,s.defaults),n.on(i.LivePreview,"enter",function(t){return e.attach(t.target)})},attach:function(t){var e=this;return!this._livePreview&&(this._livePreview=t,this.$root||this._render(),t.$iframeContainer.append(this.$root),t.$iframe.appendTo(this.$viewport),this.$trigger=h('<button class="btn bp-lp-trigger"/>').attr("title",l("Toggle screen sizes")).on("click",function(){return e.toggle()}).insertAfter(t.$editor.find(".header .btn").first()),this.retrieve(),this.update(),h(window).on("resize",function(t){return e.update()}),!0)},toggle:function(){return this._enabled?this.disable():this.enable()},enable:function(){this.$trigger.addClass("active"),this.$root.addClass("bp-lp-active"),this._enabled=!0,this.update()},disable:function(){this.$trigger.removeClass("active"),this.$root.removeClass("bp-lp-active"),this._enabled=!1,this.update()},setSize:function(t,e){this.x=parseInt(t),this.y=parseInt(e),this.update()},setZoom:function(t){this.zoom=parseFloat(t),this.update()},setPreset:function(t){var e=this.presets[t]||[null,0,0];this.currentPreset=t,this.setSize(e[1],e[2]),this.store()},rotate:function(){this.setSize(this.viewportSize.y,this.viewportSize.x)},update:function(){this.$viewport.css({width:this.isEnabled?this.x||"100%":"",height:this.isEnabled?this.y||"100%":"",transform:this.isEnabled&&1!==this.scale?"scale(".concat(this.scale,")"):""}),this.updateSizeInput("x"),this.updateSizeInput("y"),this.$zoom.find("option").first().text(l("Fit")+" ("+e(this.fitScale)+")"),this.$presets.find("option").attr("selected",!1).filter('[value="'.concat(this.currentPreset,'"]')).attr("selected",!0)},store:function(){var t,e;t="Breakpoint.LivePreview.state",e={currentPreset:this.currentPreset},window.sessionStorage[t]=JSON.stringify(e)},retrieve:function(){var t=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};try{return h.extend({},e,JSON.parse(window.sessionStorage[t]))}catch(t){return e}}("Breakpoint.LivePreview.state",{currentPreset:-1});this.setPreset(t.currentPreset)},updateSizeInput:function(t){h(this["$"+t]).val(this[t]||this.viewportSize[t]).attr("disabled",this.hasPreset)},get isEnabled(){return!!this._enabled},get presets(){return t(this.settings.presets)},get zoomLevels(){return t(this.settings.zoomLevels)},get viewportSize(){return{x:this.$viewport.width(),y:this.$viewport.height()}},get scale(){return 0<this.zoom?this.zoom:this.fitScale},get fitScale(){return Math.min(1,this.$stage.width()/this.x,this.$stage.height()/this.y)},get isSquare(){return this.x===this.y},get hasPreset(){return-1!==this.currentPreset},get presetOptions(){return this.presets.map(function(t,e){return"---"===t[0]?c():d(t[0],e)})},get zoomLevelOptions(){return this.zoomLevels.map(function(t){return d(e(t),t)})},_render:function(){var e=this,t=h('<div class="bp-lp-root"/>'),i=h('<div class="bp-lp-toolbar"/>').appendTo(t),s=h('<div class="bp-lp-stage"/>').appendTo(t),r=h('<div class="bp-lp-viewport"/>').appendTo(s),n=h('<select class="bp-lp-presets"/>').attr("title",l("Presets")).on("change",function(t){return e.setPreset(parseInt(t.target.value))}).appendTo(i).append(d(l("Responsive"),-1)).append(c()).append(this.presetOptions),a=this._makeSizeInput("x",l("Width")).appendTo(i),o=(h("<small>").text("×").appendTo(i),this._makeSizeInput("y",l("Height")).appendTo(i)),p=h('<select class="bp-lp-zoom"/>').attr("title",l("Zoom")).on("change",function(t){return e.setZoom(parseFloat(t.target.value))}).appendTo(i).append(d(l("Zoom"),-1)).append(c()).append(this.zoomLevelOptions),u=h('<button class="bp-lp-rotate"/>').attr("title",l("Rotate")).on("click",function(t){return e.rotate()}).appendTo(i);this.$root=t,this.$viewport=r,this.$stage=s,this.$zoom=p,this.$presets=n,this.$rotate=u,this.$x=a,this.$y=o},_makeSizeInput:function(s,t){var r=this;return h("<input/>").addClass("bp-lp-size-"+s).attr({title:t,disabled:!0,maxlength:4}).val(0).on("focus",function(t){return t.target.select()}).on("mouseup",function(t){return t.preventDefault()}).on("change",function(t){r[s]=Math.abs(parseInt(t.target.value)),r.update()}).on("keydown",function(t){if(t.keyCode===n.UP_KEY||t.keyCode===n.DOWN_KEY){var e=t.shiftKey?10:1,i=t.keyCode===n.UP_KEY?1:-1;r[s]=r.viewportSize[s]+e*i,r.update(),t.preventDefault()}})}},{defaults:{presets:[],zoomLevels:[]}});return s}(jQuery,Craft,Garnish);
//# sourceMappingURL=LivePreview.min.js.map
